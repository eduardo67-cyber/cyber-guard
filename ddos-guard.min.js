!function(){const e={windowMs:6e4,baseMaxRequests:80,maxRequestsPenalty:{low:0,medium:20,high:40},banMs:{low:6e4,medium:18e4,high:3e5},storageKey:"es_ddos_guard_state_v2",logging:{enabled:!0,mode:"console",beaconUrl:"/es-ddos-log",localKey:"es_ddos_guard_logs",maxEntries:50}},t=function(){try{const e=sessionStorage.getItem("es_ddos_corr_id");if(e)return e;const t=Math.random().toString(36).slice(2,10)+"-"+Date.now().toString(36);return sessionStorage.setItem("es_ddos_corr_id",t),t}catch(e){return"unknown"}}(),n=["-","0","_","ab/","acunetix","ahrefs","ahrefsbot","aiohttp","akamai","androidwebview","apachebench","appdynamics","arachni","attack","aws-health","baiduspider","batch","batch-download","beam-us-up","beautifulsoup","binaryedge","bingbot","blazemeter","blekkobot","bombardier","bot","browserless","bruteforce","burp","burpcrawler","burpsuite","censys","cfnetwork","circleci","cloud-proxy","cloudflare-diagnostic","colly","contact-scraper","crawl","crawler","crawler4j","crawling","curl","curl-lite","curl/","cypress","data-miner","data-scraper","datadog","datascraper","detectify","dirb","dirbuster","dirhunt","dirsearch","discordbot","domaincrawler","dotbot","download","downloader","duckduckbot","esp32httpclient","esp8266httpclient","exabot","facebookexternalhit","fastapi-client","fetch","fetch/","ffuf","fierce","fierce-scanner","fileget","formgrabber","forwarder","gatling","github-actions","gitlab-runner","go-http","go-http-client","goquery","grab","grabber","greynoise","grpc-go","grpc-java","headless","headless firefox","headless-khtml","headless-shell","headlesschrome","heritrix","hey/","http.rb","http4s","httpclient","httpcomponents","httpfuzz","httpie","httprobe","httptrace","httpunit","httpx","httrack","insomnia","intelbot","java","java-http","java/","jenkins","jsoup","k6","libcurl","libfetch","libwww","linkdexbot","linkpadbot","linkwalker","linux","loaderio","loadtest","locust","malicious","maltego","masscan","mechanicalsoup","mechanize","megaindex","metasploit","mj12bot","mojeekbot","mozilla/4.0 (compatible)","mozilla/5.0 (x11; linux x86_64) applewebkit/537.36","nagios","nessus","netprobe","netsparker","newrelic","newspaper","newspaper3k","nightwatch","nikto","nmap","node-fetch","null","objective-c","okhttp","okhttp/2","okhttp/3","okhttp/4","okhttps","onpagebot","openindexspider","openproxy","openvas","oracle-uptime","osint","osint-scrape","pagegrabber","paros","pattern-extractor","pentest","perl","perl/","phantom","phantomjs","php","php/","pingdom","playwright","powershell","proxy","proxy-service","pycurl","pypeteer","pyspider","python","python-httplib","python-httpx","python-requests","python-urllib","python-urllib3","python/","quake","qualys","qwantbot","rankactive","rankranger","recon","recon-ng","reconbot","rest-assured","restclient","restsharp","resttemplate","retrofit","reverse-proxy","robotframework","ruby","ruby-http","ruby/","rust-client","scanbot","scanner","screaming frog","searchmetrics","semrushbot","sentrybot","seo spider","seoanalyzer","seocheckbot","seokicks","serpstat","seznambot","shadowbrowser","shodan","siege","sistrix","skipfish","slimerjs","sniper","sogouspider","spider","spoof","sqlmap","sqlninja","sslscan","statuscake","superagent","supertest","synthetic","telegrambot","theharvester","tls-scan","tor","tor-exit","tor-relay","torbrowser","trident","tsung","twitterbot","unirest","unirest-java","unknown","uptimerobot","urlgrabber","urllib","urllib3","urlscanner","vegeta","vpn","vpngate","vscan","vsdbot","vtprobe","w3af","wapiti","wd/","webcopier","webdriver","webdriverio","webscraper","wget","wget-lite","wget/","whatweb","winhttp","wrk","x11","xspider","yandexbot","yandeximages","yandexmetrika","yandexmobile","zabbix","zgrab","zoomeye"];function saveState(t){try{localStorage.setItem(e.storageKey,JSON.stringify(t||{}))}catch(n){}}function logEvent(n,r){if(!e.logging.enabled||"silent"===e.logging.mode)return;const o={type:n,ts:(new Date).toISOString(),correlationId:t,payload:r||{}};try{if("console"===e.logging.mode)console.warn("[CyberGuard client DDoS Guard]",o);else if("beacon"===e.logging.mode&&"function"==typeof navigator.sendBeacon&&e.logging.beaconUrl)navigator.sendBeacon(e.logging.beaconUrl,JSON.stringify(o));else if("local"===e.logging.mode){const t=e.logging.localKey;let n=[];try{n=JSON.parse(localStorage.getItem(t)||"[]"),Array.isArray(n)||(n=[])}catch(a){n=[]}n.push(o),n.length>e.logging.maxEntries&&(n=n.slice(n.length-e.logging.maxEntries)),localStorage.setItem(t,JSON.stringify(n))}}catch(a){}}function showBlockScreen(e){const t=document.createElement("div");t.id="es-ddos-guard-overlay",Object.assign(t.style,{position:"fixed",inset:"0",background:"radial-gradient(circle at top, #050614 0, #02030b 55%, #000 100%)",color:"#00f5ff",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",padding:"2rem",zIndex:"99999",fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"}),t.innerHTML=`\n\t\t<h1 style="font-size:1.6rem; margin-bottom:0.75rem;">\n\t\t\tCyberGuard – Client-Side Protection\n\t\t</h1><br><br>\n\n\t\t<p style="max-width:36rem; font-size:0.95rem; opacity:0.9; line-height:1.5;">\n\t\t\t${e||"Die CyberGuard Protection hat deinen Zugriff vorübergehend eingeschränkt. Bitte warte einen Moment und lade die Seite neu. Bei fortbestehenden Problemen wende dich an den Admin\n\n<br><br>The CyberGuard protection has temporarily limited your access. Please wait a moment and reload the page. If the issue persists, please contact Admin\n\n"}\n\t\t</p>\n\n\t\t<p style="margin-top:1.5rem; font-size:0.75rem; opacity:0.7;">\n\t\t\t©Thorsten Bylicki | ©BYLICKILABS – CyberGuard\n\t\t</p>\n\n<p style="margin-top:1.2rem;">\n    <a href="https://github.com/bylickilabs"\n       target="_blank"\n       rel="noopener noreferrer"\n       style="\n           display:inline-flex;\n           align-items:center;\n           gap:0.45rem;\n           padding:0.55rem 1.1rem;\n           background:#0d1117;\n           border:1px solid #00f5ff;\n           border-radius:8px;\n           text-decoration:none;\n           color:#00f5ff;\n           font-weight:600;\n           font-size:0.95rem;\n           transition:all .22s ease;\n       "\n       onmouseover="this.style.background='#00f5ff'; this.style.color='#000';"\n       onmouseout="this.style.background='#0d1117'; this.style.color='#00f5ff';"\n    >\n        <svg height="18" width="18" viewBox="0 0 16 16" fill="currentColor">\n            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 \n            2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 \n            0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52\n            -.01-.53.63-.01 1.08.58 1.23.82.72 1.21 \n            1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78\n            -.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08\n            -.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64\n            -.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 \n            2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51\n            .56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65\n            3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93\n            -.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 \n            8c0-4.42-3.58-8-8-8z"/>\n        </svg>\n        GitHub\n    </a>\n</p>\n\n\t\t`;const append=function(){if(!document.body)return;document.getElementById("es-ddos-guard-overlay")||document.body.appendChild(t)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",append):append()}try{const t=Date.now();let r=function loadState(){try{const t=localStorage.getItem(e.storageKey);if(!t)return{};const n=JSON.parse(t);return"object"==typeof n&&null!==n?n:{}}catch(t){return{}}}();r&&"object"==typeof r||(r={});const o=navigator.userAgent||"",a=o.toLowerCase();if(r.banUntil&&t<r.banUntil)return logEvent("ban_active",{ua:o,threatLevel:r.lastThreatLevel||"unknown",score:r.lastScore||0,count:r.count||0,windowStart:r.windowStart||null,banUntil:r.banUntil}),void showBlockScreen();(!r.windowStart||t-r.windowStart>e.windowMs)&&(r.windowStart=t,r.count=0),r.count=(r.count||0)+1;const s=function evaluateThreat(t,r){const o=t.count||0,a=function matchSuspiciousUserAgent(e){const t=[];for(let r=0;r<n.length;r++){const o=n[r];-1!==e.indexOf(o.toLowerCase())&&t.push(o)}return t}(r),s=function detectHeadlessFingerprint(e){let t=0;const n=[];try{navigator.webdriver&&(t+=2,n.push("navigator.webdriver === true")),navigator.plugins&&0===navigator.plugins.length&&(t+=1,n.push("navigator.plugins.length === 0")),navigator.languages&&0===navigator.languages.length&&(t+=1,n.push("navigator.languages.length === 0")),/(headless|phantomjs|slimerjs|ghost|electron)/i.test(e)&&(t+=2,n.push("UA contains headless-related keyword")),"undefined"!=typeof window&&"chrome"in window&&-1!==e.indexOf("headlesschrome")&&(t+=2,n.push("Chrome headless signature"))}catch(r){}return{score:t,signals:n}}(r),i=function computeRateScore(e,t){if(!t||t<=0)return 0;const n=e/t;return n>=1?3:n>=.8?2:n>=.5?1:0}(o,e.baseMaxRequests),l=Math.min(a.length,3),c=l+s.score+i;let d="low";return c>=5?d="high":c>=3&&(d="medium"),{level:d,score:c,rateScore:i,uaScore:l,uaMatches:a,headlessSignals:s.signals}}(r,a),i=function getEffectiveMaxRequests(t){const n=e.maxRequestsPenalty[t]||0,r=e.baseMaxRequests-n;return r<10?10:r}(s.level),l=function getBanDuration(t){return e.banMs[t]||e.banMs.medium}(s.level);if(r.count>i)return r.banUntil=t+l,r.lastThreatLevel=s.level,r.lastScore=s.score,saveState(r),logEvent("ban_set",{ua:o,threatLevel:s.level,score:s.score,uaMatches:s.uaMatches,headlessSignals:s.headlessSignals,count:r.count,windowStart:r.windowStart,banUntil:r.banUntil,effectiveMax:i}),void showBlockScreen();r.lastThreatLevel=s.level,r.lastScore=s.score,saveState(r),"low"!==s.level&&logEvent("suspicious_activity",{ua:o,threatLevel:s.level,score:s.score,uaMatches:s.uaMatches,headlessSignals:s.headlessSignals,count:r.count,windowStart:r.windowStart,effectiveMax:i})}catch(r){try{console.error("[CyberGuard] Runtime error",r)}catch(o){}}}();
